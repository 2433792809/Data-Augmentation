å€ŸåŠ©Pytorchå®ç°æ•°æ®çš„åœ¨çº¿å¢å¹¿
â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”
-------------------------------------------------------------------------------------------------------------------------------------------------------------
âœ”å¼•è¨€
---------------------------------------------------------------------------------------------------------------------------------------------------------
æ•°æ®å¢å¹¿æ˜¯æ·±åº¦å­¦ä¹ ä¸­å¸¸ç”¨çš„æŠ€å·§ä¹‹ä¸€ï¼Œé€šè¿‡å¯¹åŸæœ‰å›¾ç‰‡è¿›è¡Œä¸€å®šç¨‹åº¦çš„éšæœºå˜åŒ–ï¼ˆå¦‚æ—‹è½¬ã€ç¼©æ”¾ã€ç¿»è½¬ã€è£å‰ªï¼‰ç”Ÿæˆä¸€ç»„æ–°çš„å›¾ç‰‡ï¼Œä»è€Œæ‰©å¤§è®­ç»ƒé›†çš„è§„æ¨¡ï¼Œè®©æ•°æ®é›†å°½å¯èƒ½çš„å¤šæ ·åŒ–ã€‚

1.è§†è§’å˜åŒ–ï¼šé€šè¿‡æ—‹è½¬ã€ç¼©æ”¾ã€ç¿»è½¬ç­‰å˜æ¢ï¼Œè®©æ¨¡å‹æ›´å¥½åœ°è¯†åˆ«ç›®æ ‡ï¼Œé¿å…å‡ºç°åªåœ¨å›ºå®šè§†è§’ä¸‹èƒ½å¤Ÿæ­£ç¡®è¯†åˆ«çš„æƒ…å†µã€‚

2.ç…§æ˜å˜åŒ–ï¼šé€šè¿‡æ”¹å˜äº®åº¦ã€å¯¹æ¯”åº¦ç­‰å‚æ•°ï¼Œæ¨¡æ‹Ÿä¸åŒçš„å…‰ç…§æ¡ä»¶ï¼Œä½¿æ¨¡å‹å¯¹å…‰ç…§æ¡ä»¶çš„å˜åŒ–æ›´åŠ é²æ£’ã€‚

3.é®æŒ¡å˜åŒ–ï¼šåœ¨å›¾ç‰‡ä¸­æ·»åŠ é®æŒ¡ç‰©ï¼Œä½¿æ¨¡å‹èƒ½å¤Ÿæ›´å¥½åœ°å¤„ç†é®æŒ¡å’Œå¤æ‚èƒŒæ™¯ã€‚

4.ç‰©ä½“å½¢å˜ï¼šé€šè¿‡å˜å½¢ã€æ‰­æ›²ç­‰å˜æ¢ï¼Œè®©æ¨¡å‹æ›´å¥½åœ°å¤„ç†ç‰©ä½“çš„å½¢å˜ï¼Œæé«˜å¯¹ä¸åŒå½¢çŠ¶ç‰©ä½“çš„è¯†åˆ«èƒ½åŠ›ã€‚

5.å™ªå£°å˜åŒ–ï¼šé€šè¿‡åŠ å…¥å™ªå£°ã€æ¨¡ç³Šç­‰å˜æ¢ï¼Œè®©æ¨¡å‹æ›´åŠ é²æ£’ï¼Œèƒ½å¤Ÿå¤„ç†å›¾åƒä¸­çš„å™ªå£°æˆ–æ¨¡ç³Šæƒ…å†µã€‚

âœ”å››å¤§æ•°æ®å¢å¹¿éœ€è¦è§£å†³çš„è§†è§‰é—®é¢˜
---------------------------------------------------------------------------------------------------------------------------------------
1.æ°´å¹³ç¿»è½¬orå‚ç›´ç¿»è½¬è¦è§£å†³å¹³ç§»ä¸å˜æ€§

2.éšæœºæ—‹è½¬----æ—‹è½¬ä¸å˜æ€§

3.éšæœºè£åˆ‡----å°ºå¯¸ä¸å˜æ€§

4.éšæœºè‰²åº¦å˜æ¢----å…‰ç…§å¤æ‚æ€§

âœ”æ•°æ®å¢å¹¿è®­ç»ƒæ¨¡å‹
-----------------------------------------------------------------------------------------------------------------------------------------
é¦–å…ˆåˆ›å»ºå¹¶é…ç½®å¥½ä¸€ä¸ªè™šæ‹Ÿç¯å¢ƒä»GitHubå…‹éš†classification-basic-sample-masteré¡¹ç›®åï¼Œæ‰“å¼€PyCharmæ‰¾åˆ°train.pyæ–‡ä»¶è¿›è¡Œæ“ä½œ

![image](https://user-images.githubusercontent.com/128702185/229296707-ea0154ec-20dc-4229-b577-b5d0dd6c114e.png)

ğŸ‘‰å‘ç°transforms.RandomResizedCropäº†å—ï¼Œè¿™æ˜¯éšæœºè£åˆ‡çš„æ„æ€ğŸ‘ˆ 

-------------------------------------------------------------------------------------------------------------------------
ğŸ‘Œå¸¸è§çš„æ•°æ®å¢å¼ºæ“ä½œåŒ…æ‹¬ï¼š

1.éšæœºæ°´å¹³ç¿»è½¬ï¼ˆHorizontal Flipï¼‰

2.éšæœºå‚ç›´ç¿»è½¬ï¼ˆVertical Flipï¼‰

3.éšæœºæ—‹è½¬ï¼ˆRandom Rotateï¼‰

4.éšæœºå‰ªè£ï¼ˆRandom Cropï¼‰

5.éšæœºç¼©æ”¾ï¼ˆRandom Scaleï¼‰

6.éšæœºåŠ å™ªå£°ï¼ˆRandom Noiseï¼‰

7.é¢œè‰²å˜æ¢ï¼ˆColor Jitteringï¼‰

8.æ•°æ®æ ‡å‡†åŒ–ï¼ˆNormalizationï¼‰

9.éšæœºæ”¹å˜å›¾ç‰‡å¯¹æ¯”åº¦ã€äº®åº¦ã€é¥±å’Œåº¦ç­‰ï¼ˆRandom Brightness/Contrast/Saturationï¼‰

------------------------------------------------------------------------------------------------------------------------------------------------
ä¸‹é¢ç»™å‡ºé€šè¿‡PyTorchä¸­çš„transformså®ç°éšæœºæ—‹è½¬å’Œæ°´å¹³ç¿»è½¬çš„æ ·ä¾‹ä»£ç ï¼Œä½ å¯ä»¥æ ¹æ®éœ€è¦å¯¹å‚æ•°è¿›è¡Œä¿®æ”¹

    train_transforms = transforms.Compose([
        transforms.RandomHorizontalFlip(p=0.5),
        transforms.RandomRotation(degrees=(-10, 10), fill=(0,)),
        transforms.ToTensor(),
        transforms.Normalize([0.5, 0.5, 0.5], [0.5, 0.5, 0.5])
    ])

å…¶ä¸­ï¼ŒRandomHorizontalFlipè¡¨ç¤ºéšæœºæ°´å¹³ç¿»è½¬ï¼ŒRandomRotationè¡¨ç¤ºéšæœºæ—‹è½¬ï¼Œdegreesä¸ºæ—‹è½¬çš„è§’åº¦èŒƒå›´ï¼Œåœ¨è¿™ä¸ªä¾‹å­ä¸­æ˜¯-10~10åº¦ï¼Œfillè¡¨ç¤ºå¡«å……é¢œè‰²ï¼Œè¿™é‡Œä½¿ç”¨0å¡«å……ã€‚pè¡¨ç¤ºéšæœºç¿»è½¬çš„æ¦‚ç‡ï¼Œè¿™é‡Œæ˜¯50%ã€‚

ä½ éœ€è¦åœ¨classification-basic-sample-masteré¡¹ç›®ä¸­åˆ›å»ºä¸€ä¸ªdataæ–‡ä»¶å¤¹

ä¿®æ”¹å¥½å‚æ•°å°±å¯ä»¥è¿›è¡Œæµ‹è¯•è®­ç»ƒäº†      â—â—â—ä¸å…‰è®­ç»ƒé›†éœ€è¦ä¿®æ”¹ï¼ŒéªŒè¯é›†ä¹Ÿé‡‡ç”¨åŒæ ·çš„å¢å¹¿â—â—â—

ä½ åº”è¯¥å¾—åˆ°ä»¥ä¸‹çš„ç»“æœ

![1  2](https://user-images.githubusercontent.com/128702185/229298959-2c999d37-d731-448e-b3a5-5c5600921f3f.png)

âœ”å¯¹å•å¼ å›¾ç‰‡è¿›è¡Œå›¾åƒå¢å¹¿
-----------------------------------------------------------------------------------------------------------------------------------------
åœ¨PyCharmä¸­çš„classification-basic-sample-masteré¡¹ç›®ä¸­æ–°å»ºä¸€ä¸ªpyæ–‡ä»¶ï¼Œè¾“å…¥ä»£ç 

    import torchvision.transforms as transforms
    from PIL import Image
    import matplotlib.pyplot as plt
    
    
    img = Image.open('data/train/train/15.jpg')
    img.show()
    augment = transforms.Compose(
      [
            # éšæœºæ°´å¹³ç¿»è½¬ï¼Œæ¦‚ç‡50%
         transforms.RandomHorizontalFlip(p=0.5),
            # éšæœºæ—‹è½¬
           transforms.RandomRotation(degrees=(-10, 10)),
            # éšæœºè£åˆ‡
         transforms.RandomResizedCrop(256)
        ]
    )

    for i in range(1,10):
        plt.subplot(3,3,i)
        plt.imshow(augment(img))
    plt.show()
    
å¦‚æœéœ€è¦åˆ«çš„å¢å¹¿æ“ä½œï¼Œå¯ä»¥å‚è€ƒ[æ•°æ®å¢å¹¿è®­ç»ƒæ¨¡å‹]è¿›è¡Œå‚æ•°ä¿®æ”¹   

è¿è¡Œä»£ç ä½ ä¼šå¾—åˆ°ä¸€ä¸ªMATLABçš„Figureçª—å£

![image](https://user-images.githubusercontent.com/128702185/229299586-90b1aaf5-30e7-4a93-9d12-68715b3688b9.png)

âœ”å¯¹cifaræ•°æ®é›†è¿›è¡Œæ•°æ®å¢å¹¿
-----------------------------------------------------------------------------------------------------------------------------------------
åœ¨PyCharmä¸­çš„classification-basic-sample-masteré¡¹ç›®ä¸­æ–°å»ºä¸€ä¸ªpyæ–‡ä»¶ï¼Œè¾“å…¥ä»£ç 

    import torch
    import torchvision
    import torchvision.transforms as transforms

    # å®šä¹‰æ•°æ®å¢å¹¿
    transform_train = transforms.Compose([
        transforms.RandomCrop(32, padding=4),  # éšæœºè£å‰ª
        transforms.RandomHorizontalFlip(),    # éšæœºæ°´å¹³ç¿»è½¬
        transforms.RandomRotation(15),        # éšæœºæ—‹è½¬
        transforms.ToTensor(),                # è½¬æ¢ä¸ºå¼ é‡
        transforms.Normalize((0.5, 0.5, 0.5), (0.5, 0.5, 0.5))  # æ ‡å‡†åŒ–
    ])

    # åŠ è½½ CIFAR-10 æ•°æ®é›†å¹¶è¿›è¡Œæ•°æ®å¢å¹¿
    trainset = torchvision.datasets.CIFAR10(root='./data', train=True,
                                           download=True, transform=transform_train)

    # ä¿å­˜å¢å¹¿åçš„æ•°æ®
    torch.save(trainset, './data/cifar10_augmented.pt')
    
 è¿™é‡Œä½¿ç”¨äº† Compose å‡½æ•°å°†å¤šä¸ªæ•°æ®å¢å¹¿æ“ä½œç»„åˆèµ·æ¥ã€‚å¯ä»¥æ ¹æ®éœ€æ±‚æ·»åŠ æˆ–è°ƒæ•´è¿™äº›å¢å¹¿æ“ä½œã€‚æœ€åä½¿ç”¨ torch.save() å°†å¢å¹¿åçš„æ•°æ®é›†ä¿å­˜åˆ°æœ¬åœ°ã€‚ä½ éœ€è¦æå‰åˆ›å»ºä¸€ä¸ª ./data æ–‡ä»¶å¤¹ã€‚   

ä½ ä¼šå¾—åˆ°ä»¥ä¸‹ç»“æœ

![æ•è·1111](https://user-images.githubusercontent.com/128702185/229334974-2dcdc2fa-038a-4fcd-be20-8f4e0a4f6d96.PNG)

å®Œæˆè®­ç»ƒåä½ ä¼šåœ¨ä½ åˆ›å»ºçš„dataæ–‡ä»¶å¤¹ä¸­çœ‹åˆ°ä¸¤ä¸ªæ–‡ä»¶ï¼Œä¸‹è½½çš„cifaræ•°æ®å’Œå®Œæˆå¢å¹¿åçš„æ•°æ®

![image](https://user-images.githubusercontent.com/128702185/229334933-7814d3b4-ee98-47be-bbc7-e95da3e2eb23.png)

âœ”æ‹“å±•
-----------------------------------------------------------------------------------------------------------------------------------------
.ptæ–‡ä»¶æ˜¯pytorchä¸­å¸¸ç”¨çš„æ¨¡å‹ä¿å­˜ã€åŠ è½½å’Œä¼ é€’çš„æ–‡ä»¶æ ¼å¼ï¼Œä¿å­˜çš„æ˜¯æ¨¡å‹å¯¹è±¡å’Œç›¸å…³å‚æ•°ã€‚å¯ä»¥é€šè¿‡torch.load()æ–¹æ³•å°†.ptæ–‡ä»¶åŠ è½½æˆpytorchçš„æ¨¡å‹å¯¹è±¡å¹¶è¿›è¡Œåç»­çš„æ“ä½œã€‚

å¯ä»¥ä½¿ç”¨ä»¥ä¸‹ä»£ç å°†.ptæ–‡ä»¶ä¸­çš„ä¸€å¼ å›¾ç‰‡ä¿å­˜ä¸º.jpgæ–‡ä»¶ï¼š

    import torch

    # Load the tensor object from the .pt file
    tensor = torch.load('./data/cifar10_augmented.pt')[0][0]

    # Convert the tensor object to an RGB PIL image
    image = transforms.ToPILImage()(tensor)

    # Save the image as a .jpg file
    image.save('./data/image.jpg')
    
è¿™ä¸ªä»£ç ä¼šå°†ç¬¬ä¸€å¼ å›¾ç‰‡ä».ptæ–‡ä»¶ä¸­è¯»å–å‡ºæ¥ï¼Œå¹¶å°†å…¶è½¬æ¢æˆPILå›¾ç‰‡æ ¼å¼ã€‚ç„¶åä½¿ç”¨PILåº“å°†å›¾ç‰‡ä¿å­˜ä¸º.jpgæ ¼å¼

![image](https://user-images.githubusercontent.com/128702185/229335127-21497803-ee5a-4c26-bdf7-fc81b739908d.png)
